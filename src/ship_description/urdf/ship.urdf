<?xml version="1.0"?>
<robot name="ship" xmlns:xacro="http://ros.org/wiki/xacro">
	
	<material name="grey">
	        <color rgba="0.5 0.5 0.5 1" />
    	</material>
	
	<material name="blue">
   		<color rgba="0 0 0.8 1"/>
  	</material>
  	
	  <link name="base_footprint"/>
	 
    	<joint name="base_joint" type="fixed">
        	<parent link="base_footprint"/>
        	<child link="base_link"/>
        	<origin xyz="0 0 0" rpy="0 0 0"/>
    	</joint>
    	
    	<link name="base_link">
			<inertial>
      			<origin xyz="0 0 0" rpy="0 0 0"/>
      			<mass value="30.0"/>
      			<inertia ixx="2.5" ixy="0.0" ixz="0.0"
               		iyy="4.0" iyz="0.0"
               		izz="5.5"/>
    		</inertial>

    		<visual>
            	<geometry>
                	<box size="1.2 0.5 0.3" />
            	</geometry>
            	<origin xyz="0 0 -0.05" rpy="0 0 0" />
            	<material name="blue" />
        	</visual>

        	<collision>
        		<geometry>
            		<box size="1.2 0.5 0.3" />
        		</geometry>
        		<origin xyz="0 0 -0.05" rpy="0 0 0"/>
  			</collision>

  			<gazebo>
				<mu1>0.1</mu1> <!-- sürtünme -->
    			<mu2>0.1</mu2>
    			<kp>100</kp>   <!-- damping gain -->
    			<kd>10</kd>
  				<plugin name="diff_drive_controller" filename="libgazebo_ros_diff_drive.so">
   					<ros>
        				<remapping>cmd_vel:=/cmd_vel</remapping>
        				<remapping>odom:=/odom</remapping>
    				</ros>
   		 			<left_joint>left_thruster_joint</left_joint>
    				<right_joint>right_thruster_joint</right_joint>
    				<wheel_separation>0.4</wheel_separation>
   					<wheel_radius>0.1</wheel_radius>
    				<odom_frame>odom</odom_frame>
    				<base_frame>base_link</base_frame>
				</plugin>
			</gazebo>
			<gazebo>
  				<plugin name="imu_plugin" filename="libgazebo_ros_imu.so">
    				<ros>
      					<namespace></namespace>
      					<remapping>imu:=/imu</remapping>
    				</ros>
    				<update_rate>50</update_rate>
    				<body_name>base_link</body_name>
      				<frame_name>imu_link</frame_name>
  				</plugin>
			</gazebo>
    	</link>
    	
		<!-- IMU link ve joint tanımı -->
	<joint name="imu_joint" type="fixed">
    	<parent link="base_link"/>
    	<child link="imu_link"/>
    	<origin xyz="0 0 0.05" rpy="0 0 0"/>
	</joint>

	<link name="imu_link">
    	<inertial>
        	<origin xyz="0 0 0" rpy="0 0 0"/>
        	<mass value="0.1"/>
        	<inertia ixx="0.0001" ixy="0.0" ixz="0.0"
                 iyy="0.0001" iyz="0.0"
                 izz="0.0001"/>
    	</inertial>
    	<visual>
        	<geometry>
            	<box size="0.05 0.05 0.02"/>
        	</geometry>
        	<origin xyz="0 0 0" rpy="0 0 0"/>
        	<material name="grey"/>
    	</visual>
	</link>

	<!-- IMU plugin Gazebo için -->
	<gazebo>
    	<plugin name="imu_plugin" filename="libgazebo_ros_imu.so">
        	<ros>
            	<namespace></namespace>
            	<remapping>imu:=/imu</remapping>
        	</ros>
        	<update_rate>50</update_rate>
        	<body_name>base_link</body_name>
        	<frame_name>imu_link</frame_name>
    	</plugin>
	</gazebo>

    	<joint name="base_scan_joint" type="fixed">
        	<parent link="base_link"/>
        	<child link="base_scan"/>
        	<origin xyz="0 0 0.15" rpy="0 0 0"/>
    	</joint>
    
    	<link name="base_scan">
        	<visual>
            	<geometry>
                	<cylinder radius="0.06" length="0.07"/>
            	</geometry>
        		<origin xyz="0 0 0" rpy="1.57 0 0" />
        		<material name="grey" />
        	</visual>

        	<gazebo>
  				<sensor type="ray" name="lidar_sensor">
    				<update_rate>20</update_rate>
    				<visualize>true</visualize>
    				<ray>
      					<scan>
        					<horizontal>
          						<samples>360</samples>
          						<resolution>1</resolution>
          						<min_angle>-1.57</min_angle>
          						<max_angle>1.57</max_angle>
        					</horizontal>
      					</scan>
      					<range>
        					<min>0.1</min>
        					<max>20.0</max>
        					<resolution>0.01</resolution>
      					</range>
    				</ray>
    				<plugin name="gazebo_ros_laser" filename="libgazebo_ros_laser.so">
      					<ros>
            					<namespace></namespace>
            					<remapping>scan:=/scan</remapping>
          				</ros>
          				<frameName>base_scan</frameName>
    				</plugin>
  				</sensor>
			</gazebo>
    	</link>
    	
    	<joint name="left_thruster_joint" type="continuous">
        	<parent link="base_link"/>
        	<child link="left_thruster_link"/>
        	<origin xyz="-0.5 0.2 -0.05" rpy="0 0 0"/>
			<axis xyz="0 0 1"/>
    	</joint>

    	<link name="left_thruster_link">
			<inertial>
    			<origin xyz="0 0 0" />
    			<mass value="0.5"/>
    			<inertia ixx="0.001" ixy="0" ixz="0"
             		iyy="0.001" iyz="0"
             		izz="0.001"/>
  			</inertial>
			<gazebo>
    			<mu1>0.1</mu1> <!-- sürtünme -->
    			<mu2>0.1</mu2>
    			<kp>100</kp>   <!-- damping gain -->
    			<kd>10</kd>
			</gazebo>
			<visual>
            		<geometry>
                		<cylinder radius="0.03" length="0.1"/>
            		</geometry>
            		<origin xyz="0 0 0" rpy="1.57 0 0" />
            		<material name="grey" />
        	</visual>
        	<collision>
        		<geometry>
            			<cylinder radius="0.03" length="0.1"/>
        		</geometry>
        		<origin xyz="0 0 0" rpy="1.57 0 0"/>
    		</collision>
    	</link>
    
    	<joint name="right_thruster_joint" type="continuous">
    		<parent link="base_link"/>
    		<child link="right_thruster_link"/>
    		<origin xyz="-0.5 -0.2 -0.05" rpy="0 0 0"/>
			<axis xyz="0 0 1"/>
    	</joint>

    	<link name="right_thruster_link">
			<inertial>
    			<origin xyz="0 0 0" />
    			<mass value="0.5"/>
    			<inertia ixx="0.001" ixy="0" ixz="0"
             		iyy="0.001" iyz="0"
             		izz="0.001"/>
  			</inertial>
			<gazebo>
    			<mu1>0.1</mu1> <!-- sürtünme -->
    			<mu2>0.1</mu2>
    			<kp>100</kp>   <!-- damping gain -->
    			<kd>10</kd>
			</gazebo>
    	    <visual>
    	        <geometry>
    	            <cylinder radius="0.03" length="0.1"/>
    	        </geometry>
    	        <origin xyz="0 0 0" rpy="1.57 0 0" />
    	        <material name="grey" />
    	    </visual>
    	    	<collision>
        		<geometry>
        			<cylinder radius="0.03" length="0.1"/>
      			</geometry>
        		<origin xyz="0 0 0" rpy="1.57 0 0"/>
        	</collision>
    	</link>

</robot>
